---
import { SearchCheck, Cpu, Wrench, LineChart } from "lucide-astro";
import SectionArrow from "./common/SectionArrow.astro";

const steps = [
  {
    num: "01.",
    title: "Estudio T√©cnico",
    icon: SearchCheck,
    img: "/public/process-1.png",
    desc: "Recolectamos data con drones, c√°maras t√©rmicas, medidores ultras√≥nicos, analizador de redes e IA para entender tu consumo real.",
  },
  {
    num: "02.",
    title: "Dise√±o a Medida",
    icon: Cpu,
    img: "/public/process-2.png",
    desc: "Modelamos la soluci√≥n usando Helioscope, PVSyst y dise√±o estructural para garantizar eficiencia y compatibilidad t√©cnica.",
  },
  {
    num: "03.",
    title: "Implementaci√≥n",
    icon: Wrench,
    img: "/public/process-3.png",
    desc: "Instalamos y coordinamos el sistema sin detener tus operaciones. Procesos limpios, precisos y seguros.",
  },
  {
    num: "04.",
    title: "Monitoreo & Beneficio",
    icon: LineChart,
    img: "/public/process-4.png",
    desc: "Monitoreo inteligente con IA y apps de inversores para garantizar ahorro real y continuidad operativa.",
  },
];
---

<section id="proceso" class="relative min-h-screen w-full bg-(--bg) px-6 md:px-16 lg:px-24 py-20">

  <!-- ‚≠ê TITULO SUPERIOR -->
  <div class="text-center mb-14">
    <h2 class="text-4xl md:text-5xl font-semibold text-(--primary)">
      Nuestro Proceso
    </h2>
    <p class="text-(--text)/70 mt-2 tracking-wide text-sm md:text-base">
      Ingenier√≠a ‚Ä¢ Datos ‚Ä¢ Precisi√≥n
    </p>
  </div>

  <!-- ‚≠ê DESKTOP BENTO GRID -->
  <div 
    class="max-w-6xl mx-auto relative 
           hidden lg:grid h-[65vh] grid-cols-12 grid-rows-6 gap-6"
  >

    <!-- üü¶ ESTUDIO -->
    <div class="col-span-5 row-span-3 rounded-3xl overflow-hidden shadow-xl relative group">
      <img src={steps[0].img} class="absolute inset-0 w-full h-full object-cover opacity-80 group-hover:scale-105 transition-all duration-700" />
      <div class="absolute inset-0 bg-black/40 group-hover:bg-black/30 transition-all duration-500"></div>

      <div class="absolute bottom-6 left-6 text-white">
        <steps[0].icon class="w-8 h-8 mb-2 opacity-80" />
        <h3 class="text-xl font-semibold tracking-wide p-2 bg-amber-50/50 rounded-lg">
          <span class="text-(--secondary) font-bold mr-1">{steps[0].num}</span>
          {steps[0].title}
        </h3>
        <p class="text-sm md:text-base leading-relaxed max-w-sm opacity-90">
          {steps[0].desc}
        </p>
      </div>
    </div>

    <!-- üîµ Conexi√≥n Horizontal -->
    <div class="col-start-6 col-end-8 row-start-2 row-end-3 flex items-center">
      <div class="w-full h-[2px] bg-gradient-to-r from-(--primary)/20 via-(--secondary)/40 to-(--primary)/20 
                  relative overflow-hidden rounded-full">
        <div class="absolute inset-0 animate-flow-line bg-gradient-to-r 
                    from-transparent via-(--secondary) to-transparent opacity-60"></div>
        <span class="absolute right-0 -top-[3px] w-3 h-3 rotate-45 border-t-2 border-r-2 border-(--secondary)"></span>
      </div>
    </div>

    <!-- üüß DISE√ëO -->
    <div class="col-start-8 col-end-13 row-span-2 rounded-3xl overflow-hidden shadow-xl relative group">
      <img src={steps[1].img} class="absolute inset-0 w-full h-full object-cover opacity-80 group-hover:scale-105 transition-all duration-700" />
      <div class="absolute inset-0 bg-black/40 group-hover:bg-black/30 transition-all duration-500"></div>

      <div class="absolute bottom-6 left-6 text-white">
        <steps[1].icon class="w-7 h-7 mb-2 opacity-80" />
        <h3 class="text-lg font-semibold p-2 bg-amber-50/50 rounded-lg">
          <span class="text-(--secondary) font-bold mr-1">{steps[1].num}</span>
          {steps[1].title}
        </h3>
        <p class="text-sm md:text-base leading-relaxed max-w-sm opacity-90">
          {steps[1].desc}
        </p>
      </div>
    </div>

    <!-- üîµ Conexi√≥n Vertical -->
    <div class="col-start-10 col-end-11 row-start-3 row-end-5 flex justify-center">
      <div class="h-full w-[2px] bg-gradient-to-b from-(--primary)/20 via-(--secondary)/40 to-(--primary)/20 
                  relative overflow-hidden rounded-full">
        <div class="absolute inset-0 animate-flow-vertical bg-gradient-to-b 
                    from-transparent via-(--secondary) to-transparent opacity-60"></div>
        <span class="absolute bottom-0 -left-[3px] w-3 h-3 -rotate-45 border-b-2 border-r-2 border-(--secondary)"></span>
      </div>
    </div>

    <!-- üü® IMPLEMENTACI√ìN -->
    <div class="col-span-4 row-start-4 row-span-3 rounded-3xl overflow-hidden shadow-xl relative group">
      <img src={steps[2].img} class="absolute inset-0 w-full h-full object-cover opacity-80 group-hover:scale-105 transition-all duration-700" />
      <div class="absolute inset-0 bg-black/40 group-hover:bg-black/30 transition-all duration-500"></div>

      <div class="absolute bottom-6 left-6 text-white">
        <steps[2].icon class="w-7 h-7 mb-2 opacity-80" />
        <h3 class="text-lg font-semibold p-2 bg-amber-50/50 rounded-lg w-[55%]">
          <span class="text-(--secondary) font-bold mr-1">{steps[2].num}</span>
          {steps[2].title}
        </h3>
        <p class="text-sm md:text-base leading-relaxed max-w-sm opacity-90">
          {steps[2].desc}
        </p>
      </div>
    </div>

    <!-- üîµ Conexi√≥n Horizontal hacia Beneficio -->
    <div class="col-start-5 col-end-7 row-start-5 row-end-6 flex items-center">
      <div class="w-full h-[2px] bg-gradient-to-r from-(--primary)/20 via-(--secondary)/40 to-(--primary)/20 
                  relative overflow-hidden rounded-full">
        <div class="absolute inset-0 animate-flow-line bg-gradient-to-r 
                    from-transparent via-(--secondary) to-transparent opacity-60"></div>
        <span class="absolute right-0 -top-[3px] w-3 h-3 rotate-45 border-t-2 border-r-2 border-(--secondary)"></span>
      </div>
    </div>

    <!-- üü© MONITOREO & BENEFICIO -->
    <div class="col-start-7 col-end-13 row-start-4 row-span-3 rounded-3xl overflow-hidden shadow-xl relative group">
      <img src={steps[3].img} class="absolute inset-0 w-full h-full object-cover opacity-80 group-hover:scale-105 transition-all duration-700" />
      <div class="absolute inset-0 bg-black/35 group-hover:bg-black/25 transition-all duration-500"></div>

      <div class="absolute bottom-6 left-6 text-white">
        <steps[3].icon class="w-8 h-8 mb-2 opacity-80" />
        <h3 class="text-xl font-semibold drop-shadow-2xl p-2 bg-amber-50/50 rounded-lg">
          <span class="text-(--secondary) font-bold mr-1">{steps[3].num}</span>
          {steps[3].title}
        </h3>
        <p class="text-sm md:text-base leading-relaxed max-w-sm opacity-90">
          {steps[3].desc}
        </p>
      </div>
    </div>

  </div>

  <!-- ‚≠ê MOBILE LAYOUT -->
  <div class="lg:hidden flex flex-col gap-8 px-3 mt-10">

    {steps.map(({ num, title, desc, img, icon: Icon }) => (
      <div class="rounded-2xl overflow-hidden shadow-lg bg-white/90 backdrop-blur-sm">

        <!-- Imagen -->
        <div class="h-52 w-full overflow-hidden">
          <img 
            src={img} 
            class="w-full h-full object-cover transition-all duration-700 hover:scale-105" 
          />
        </div>

        <!-- Texto -->
        <div class="p-6">
          <div class="flex items-center gap-2 mb-2">
            <Icon class="w-6 h-6 text-(--primary)" />
            <span class="text-(--secondary) font-bold">{num}</span>
          </div>

          <h3 class="text-lg font-semibold text-(--primary) mb-2">
            {title}
          </h3>

          <p class="text-(--text)/80 text-sm leading-relaxed">
            {desc}
          </p>
        </div>

      </div>
    ))}

  </div>

  <!-- ‚≠ê FLECHA ABAJO -->
  <SectionArrow targetId="nosotros" />

</section>

<style>
  @keyframes flowLine {
    0% { transform: translateX(-100%); }
    100% { transform: translateX(100%); }
  }
  @keyframes flowVertical {
    0% { transform: translateY(-100%); }
    100% { transform: translateY(100%); }
  }
  .animate-flow-line {
    animation: flowLine 3s linear infinite;
  }
  .animate-flow-vertical {
    animation: flowVertical 3s linear infinite;
  }
</style>
