---
import { ArrowRight } from "lucide-astro";
import { Image } from "astro:assets";

// üî• Importaci√≥n optimizada de im√°genes locales
import hero1 from "../assets/hero-1.png";
import hero2 from "../assets/hero-2.png";

// üî• GIF remoto ‚Üí no se optimiza, se usa tal cual
const images = [
  {
    src: "https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExNTB1M205OTBqZTVoZGppamM2NG0wNTVqdTF3NG5hd2k4d3A4NXhxNSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/E9jYbCjTQGqTGdIkya/giphy.gif",
    animated: true,
    alt: "Animaci√≥n t√©cnica representando energ√≠a inteligente."
  },
  {
    src: hero2,
    animated: false,
    alt: "Paneles solares industriales de gran escala."
  },
  {
    src: hero1,
    animated: false,
    alt: "Equipo de ingenier√≠a energ√©tica trabajando en campo."
  }
];
---

<section id="inicio" class="relative w-full h-screen overflow-hidden bg-black">

  <!-- ========================== -->
  <!-- ‚≠ê CARRUSEL DE IM√ÅGENES ‚≠ê -->
  <!-- ========================== -->
  <div
    id="carousel"
    class="absolute inset-0 flex transition-transform duration-[1200ms] ease-out"
  >
    {images.map((img) => (
      <div class="min-w-full h-full relative">

        {img.animated ? (
          <!-- üî• GIF normal -->
          <img
            src={img.src}
            alt={img.alt}
            class="w-full h-full object-cover brightness-[0.90] saturate-110 contrast-[1.15]"
          />
        ) : (
          <!-- üî• PNG/JPG optimizado autom√°ticamente a WebP -->
          <Image
            src={img.src}
            alt={img.alt}
            width={2200}
            quality={85}
            format="webp"
            class="w-full h-full object-cover brightness-[0.75] saturate-110 contrast-[1.15]"
          />
        )}

        <!-- Overlay -->
        <div class="absolute inset-0 bg-gradient-to-r from-black/40 via-black/35 to-black/10"></div>
      </div>
    ))}
  </div>

  <!-- ========================== -->
  <!-- ‚≠ê TEXTO Y BOT√ìN ‚≠ê -->
  <!-- ========================== -->
  <div class="absolute top-1/2 left-1/2 -translate-x-1/2 
              -translate-y-1/2 text-center z-20 max-w-2xl text-white">

    <span class="inline-block px-4 py-1 mb-5 rounded-full 
                bg-white/20 backdrop-blur-sm text-xs tracking-wide uppercase">
      Energ√≠a Inteligente
    </span>

    <h1 class="text-4xl md:text-6xl text-(--secondary) font-semibold leading-tight mb-4 drop-shadow-[0_2px_10px_rgba(0,0,0,0.55)]">
      Varias soluciones,<br />
      <span class="text-(--primary)">un mismo fin.</span>
    </h1>

    <div class="w-24 h-0.5 bg-white/40 mx-auto mb-6"></div>

    <p class="text-lg opacity-90 mb-8 mx-auto max-w-lg">
      La energ√≠a que mueve acuerdos.
    </p>

    <!-- BOT√ìN -->
    <a
      href="#contacto"
      class="relative inline-flex items-center gap-2 px-8 py-3 text-sm tracking-wide rounded-lg overflow-hidden
             bg-(--primary) text-white font-semibold transition-all duration-500 group active:scale-95 shadow-[0_4px_20px_rgba(0,0,0,0.1)]">

      <span
        class="absolute inset-0 bg-gradient-to-r from-(--primary) via-(--secondary) to-(--primary)
               opacity-0 group-hover:opacity-100 blur-[3px] scale-105 animate-gradient rounded-lg">
      </span>

      <span class="relative z-10 flex items-center gap-2">
        Descubre m√°s 
        <ArrowRight class="w-4 h-4 group-hover:scale-125 transition-all" />
      </span>
    </a>
  </div>

  <!-- ========================== -->
  <!-- ‚≠ê DOTS ‚≠ê -->
  <!-- ========================== -->
  <div class="absolute bottom-16 lg:bottom-10 left-1/2 -translate-x-1/2 flex gap-3 z-30">
    {images.map((_, i) => (
      <button
        class="dot w-3 h-3 rounded-full bg-white/40 hover:bg-white transition"
        data-index={i}
      ></button>
    ))}
  </div>

</section>

<!-- ========================== -->
<!-- ‚≠ê SCRIPT DEL CARROUSEL ‚≠ê -->
<!-- ========================== -->
<script is:client>
  const carousel = document.getElementById("carousel");
  const dots = document.querySelectorAll(".dot");
  let index = 0;

  function updateCarousel(i) {
    index = i;
    carousel.style.transform = `translateX(-${index * 100}%)`;

    dots.forEach((dot, j) => {
      dot.style.backgroundColor = j === index ? "white" : "rgba(255,255,255,0.4)";
      dot.style.transform = j === index ? "scale(1.3)" : "scale(1)";
    });
  }

  dots.forEach((dot) => {
    dot.addEventListener("click", () =>
      updateCarousel(parseInt(dot.dataset.index))
    );
  });

  // Auto-play
  setInterval(() => {
    updateCarousel((index + 1) % dots.length);
  }, 6000);
</script>
